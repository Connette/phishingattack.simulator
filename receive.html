<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Receive Phishing</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <div class="logo-container">
            <img src="logo.svg" alt="Logo" class="logo">
        </div>
        <h1>Phishing Attack Simulator</h1>
        <div class="toggle-container">
            <span style="font-weight: bold;">Dark Mode</span>
            <label class="switch">
                <input type="checkbox" id="toggleDark">
                <span class="slider"></span>
            </label>
        </div>
        <button class="logout-btn" onclick="logout()" aria-label="Logout">
            <svg class="logout-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                <path d="M12 2v11" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M5 12a7 7 0 0014 0" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="logout-text">Logout</span>
        </button>
    </div>

    <nav class="nav">
        <a href="dashboard.html" class="nav-link">Dashboard & Scenarios</a>
        <a href="analysis.html" class="nav-link">Analysis Templates</a>
        <a href="receive.html" class="nav-link active">User's POV</a>
        <a href="simulation.html" class="nav-link">Simulation Area</a>
    </nav>
    
    <div class="receive-container">
        <div class="card">
            <h2 style="text-align:center">üì¨ You've Received a Message</h2>
            <p style="text-align:center; margin-bottom: 25px;">This is how the phishing attempt would appear to you. Decide whether to interact with it or ignore it.</p>
            
            <div id="receiveContainer" style="min-height: 300px; text-align: center;">
                <p>Loading message...</p>
                <div class="card receive-box" id="receiveBox">
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load the selected template when the receive page loads
            const type = localStorage.getItem('currentPhishTemplate');
            if (type) {
                // Manually construct and inject the content since we can't call loadTemplate directly
                const box = document.getElementById('receiveBox');
                box.style.display = 'block';
                let content = '';

                if (type === 'email') {
                    content = `
                        <div style="border: 2px solid var(--border); border-radius: 8px; padding: 20px; background: var(--card); text-align: left;">
                            <p><strong>From:</strong> security-alert@gmail-security.com</p>
                            <p><strong>Subject:</strong> Important: Action Required on Your Google Account</p>
                            <hr style="border: none; border-top: 1px solid var(--border);">
                            <div style="padding: 15px; background: var(--bg); border-radius: 6px;">
                                <h4 style="margin-top: 0;">Account Restricted</h4>
                                <p>Dear user,</p>
                                <p>We detected unusual security activity in your Google account. Please verify your login details to avoid account suspension.</p>
                                <br>
                                <a href="#" onclick="handlePhishLink('email'); return false;" class="phish-link-btn">Verify your account</a>
                            </div>
                            <p style="font-size: 0.85em; color: var(--text); opacity: 0.7; margin-top: 15px;">gmail.com | Help | Report abuse</p>
                        </div>
                        <div style="display:flex; gap:10px; margin-top:20px; flex-wrap:wrap;">
                            <button class="phish-action-btn" onclick="handlePhishLink('email')">Click the Link</button>
                            <button class="spam-btn" onclick="ignorePhish()">üö´ Ignore/Spam</button>
                        </div>
                        <p class="result" id="resultMsg"></p>
                    `;
                } else if (type === 'bank') {
                    content = `
                        <div style="border: 2px solid var(--border); border-radius: 8px; padding: 20px; background: var(--card); text-align: left;">
                            <p><strong>From:</strong> security@yourbank.com-secures.net</p>
                            <p><strong>Subject:</strong> Urgent: Unusual Activity Detected - Action Required</p>
                            <hr style="border: none; border-top: 1px solid var(--border);">
                            <div style="padding: 15px; background: var(--bg); border-radius: 6px;">
                                <h4 style="margin-top: 0; color: var(--danger);">üè¶ Bank Security Alert</h4>
                                <p>We have temporarily suspended online access to your account due to suspicious transactions.</p>
                                <p style="font-weight: bold; color: var(--danger);">FAILURE TO ACT WITHIN 24 HOURS WILL RESULT IN ACCOUNT LOCKOUT.</p>
                                <br>
                                <a href="#" onclick="handlePhishLink('bank'); return false;" class="phish-link-btn">Click Here to Log In Securely</a>
                            </div>
                            <p style="font-size: 0.85em; color: var(--text); opacity: 0.7; margin-top: 15px;">yourbank.com | Help | Report abuse</p>
                        </div>
                        <div style="display:flex; gap:10px; margin-top:20px; flex-wrap:wrap;">
                            <button class="phish-action-btn" onclick="handlePhishLink('bank')">Click the Link</button>
                            <button class="spam-btn" onclick="ignorePhish()">üö´ Ignore/Spam</button>
                        </div>
                        <p class="result" id="resultMsg"></p>
                    `;
                } else if (type === 'popup') {
                    content = `
                        <div style="border: 2px solid var(--danger); border-radius: 8px; padding: 20px; background: var(--card); text-align: center;">
                            <h4 style="color: var(--danger); margin-top: 0;">‚ö†Ô∏è CRITICAL SYSTEM ALERT</h4>
                            <p style="font-weight: bold; color: var(--danger);">ERROR CODE: 0x80070005</p>
                            <div style="padding: 15px; background: #fff3cd; border-radius: 6px; border-left: 4px solid var(--danger);">
                                <p><strong>Unsecured Connection Detected!</strong></p>
                                <p>Your IP address is broadcasting sensitive information.</p>
                                <p style="font-weight: bold;">Action Required: Your firewall has been compromised. Please re-validate your device login credentials immediately.</p>
                                <br>
                                <button class="phish-action-btn" onclick="handlePhishLink('popup')">Re-validate Now</button>
                            </div>
                            <p style="font-size: 0.85em; color: var(--text); opacity: 0.7; margin-top: 15px;">Note: This is a simulated browser pop-up</p>
                        </div>
                        <div style="display:flex; gap:10px; margin-top:20px; flex-wrap:wrap; justify-content:center;">
                            <button class="phish-action-btn" onclick="handlePhishLink('popup')">Re-validate</button>
                            <button class="spam-btn" onclick="ignorePhish()">üö´ Close/Ignore</button>
                        </div>
                        <p class="result" id="resultMsg"></p>
                    `;
                }
                box.innerHTML = content;
                localStorage.removeItem('currentPhishTemplate'); // Clear the flag
            }
        });

        function handlePhishLink(type) {
            let state = getState();
            state.attempts++;
            state.fails++;
            saveState(state);
            updateDashboard();
            
            // Store the selected template and forward to simulation area
            localStorage.setItem('currentPhishTemplate', type);
            window.location.href = 'simulation.html'; // Navigate to the simulation area
        }
    </script>
</body>
</html>
